<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>LaluLintasKu â€” Laporan</title>
<style>
:root{
  --green:#007a1c;
  --green-dark:#005c15;
  --card-bg:#ffffff;
  --page-bg:#ffffff; /* putih polos */
  --panel-bg: rgba(0,0,0,0.6);
}

/* BODY */
body{
  margin:0;
  font-family: Inter, system-ui, Arial, sans-serif;
  background: var(--page-bg);
}

/* HEADER */
.header {
  background: var(--green);
  color: white;
  padding: 12px 16px;
  text-align: center;
  position: relative;
}
.header .menu-btn{
  position: absolute; left: 12px; top: 8px; font-size: 22px; cursor:pointer;
}
.header h1{ margin:0; font-size:20px; display:inline-block; vertical-align:middle; }

/* SIDEBAR */
.sidebar {
  position: fixed;
  top:0;
  left:-240px; /* sembunyi default */
  width:240px;
  height:100%;
  background: var(--panel-bg);
  color:#fff;
  padding-top:60px;
  transition:left .25s ease;
  z-index:2000; /* pastikan di atas konten */
}
.sidebar.active{ left:0; }
.sidebar a{ display:block; padding:12px 18px; color:#fff; text-decoration:none; font-size:15px; }
.sidebar a:hover{ background: rgba(255,255,255,0.08); }

/* MAIN CONTENT AREA */
.main {
  padding:24px;
  max-width:1000px;
  margin: 24px auto;
}

/* FORM CARD */
.card {
  background: rgba(255,255,255,0.95);
  border-radius: 18px;
  padding: 28px;
  box-shadow: 0 8px 22px rgba(0,0,0,0.08);
  margin: 12px auto;
  max-width: 620px;
  text-align: center;
}
.card h2{ margin-top:0; margin-bottom:12px; color:#111; }
label{ display:block; margin:10px 0 6px; color:#333; font-size:14px; }
select, textarea, input[type="text"]{
  width:92%;
  max-width:560px;
  padding:10px 12px;
  border-radius:10px;
  border:1px solid #d0d0d0;
  font-size:15px;
  box-sizing: border-box;
  background: #fff;
}
textarea{ min-height:110px; resize:vertical; }
.btn{
  margin-top:16px;
  background:var(--green);
  color:white; border:none; padding:10px 18px; border-radius:8px; cursor:pointer;
  font-weight:600;
}
.btn:hover{ background:var(--green-dark); }

/* Statistik table */
.stats-card{ max-width:900px; margin:18px auto; padding:18px; border-radius:12px; background:#fff; box-shadow:0 6px 18px rgba(0,0,0,0.06);}
table{ width:100%; border-collapse:collapse; margin-top:12px;}
th,td{ padding:8px 10px; border:1px solid #e6e6e6; text-align:center; font-size:14px;}
th{ background:#f7faf7; color:#222; }
.status-lancar{ color:green; font-weight:700; }
.status-ramai{ color:orange; font-weight:700; }
.status-padat{ color:#c67a00; font-weight:700; }
.status-macet{ color:red; font-weight:700; }

/* responsive */
@media (max-width:640px){
  .card{ padding:18px; border-radius:14px; width:94%; }
  select,input,textarea{ width:100%; }
  .sidebar{ width:220px; }
}

/* small helper */
.muted{ color:#666; font-size:13px; margin-top:8px; }
.small{ font-size:13px; color:#444; }
</style>
</head>
<body>

<header class="header">
  <span class="menu-btn" id="menuBtn">â˜°</span>
  <h1>ðŸš¦ LaluLintasKuhj</h1>
</header>
<img src="logo.png" alt="Logo" id="logoSmall">

<nav class="sidebar" id="sidebar">
  <a href="#" onclick="goto('laporan')">ðŸ“‹ Laporan</a>
  <a href="#" onclick="goto('statistik')">ðŸ“Š Statistik</a>
  <a href="#" onclick="goto('aman')">ðŸš— Cara Mengemudi Aman</a>
  <a href="#" onclick="goto('login')">ðŸ”‘ Login</a>
</nav>

<main class="main">
  <!-- FORM -->
  <section id="laporanSection" class="card">
    <h2>Laporan Lalu Lintas</h2>
    <label for="provinsi">Pilih Provinsi:</label>
    <select id="provinsi">
      <option value="">-- Pilih Provinsi --</option>
      <option value="Jawa Timur">Jawa Timur</option>
      <option value="Jawa Barat">Jawa Barat</option>
      <option value="DKI Jakarta">DKI Jakarta</option>
    </select>

    <div id="kotaWrap" style="display:none;">
      <label for="kota">Pilih Kota/Kabupaten:</label>
      <select id="kota"><option value="">-- Pilih Kota --</option></select>
    </div>

    <div id="daerahWrap" style="display:none;">
      <label for="daerah">Pilih Daerah/Kecamatan:</label>
      <select id="daerah"><option value="">-- Pilih Daerah --</option></select>
    </div>

    <div id="statusWrap" style="display:none;">
      <label for="status">Status Kondisi:</label>
      <select id="status">
        <option value="">-- Pilih Kondisi --</option>
        <option value="Lancar">Lancar</option>
        <option value="Ramai">Ramai</option>
        <option value="Padat">Padat</option>
        <option value="Macet">Macet</option>
      </select>
    </div>

    <div id="descWrap" style="display:none;">
      <label for="deskripsi">Deskripsi (opsional):</label>
      <textarea id="deskripsi" placeholder="Contoh: Lampu merah tidak berfungsi / antrean 500m (boleh dikosongkan)"></textarea>
    </div>

    <div id="submitWrap" style="display:none;">
      <button class="btn" id="submitBtn">Kirim Laporan</button>
      <div class="muted">Laporan akan masuk ke ringkasan dan statistik.</div>
    </div>

    <div id="summary" style="margin-top:18px;"></div>
  </section>

  <section id="statistikSection" class="stats-card" style="display:none;">
    <h3>ðŸ“Š Statistik Laporan (Dari semua laporan)</h3>
    <div id="statsSummary" class="small">Belum ada laporan.</div>
    <table id="statsTable" style="margin-top:12px; display:none;">
      <thead>
        <tr>
          <th>Daerah (Kota)</th>
          <th>Lancar</th>
          <th>Ramai</th>
          <th>Padat</th>
          <th>Macet</th>
          <th>Total</th>
          <th>Mayoritas</th>
        </tr>
      </thead>
      <tbody id="statsTbody"></tbody>
    </table>
    <h4 style="margin-top:14px;">Laporan Terbaru</h4>
    <div id="recentList" class="small" style="text-align:left;"></div>
  </section>

  <section id="amanSection" class="card" style="display:none;">
    <h3>Cara Mengemudi dengan Aman</h3>
    <ul style="text-align:left;">
      <li>Gunakan helm atau sabuk pengaman.</li>
      <li>Patuhi rambu lalu lintas dan lampu isyarat.</li>
      <li>Jaga jarak aman antar kendaraan.</li>
      <li>Hindari penggunaan HP saat berkendara.</li>
      <li>Jika lelah, berhenti dan istirahat.</li>
    </ul>
  </section>

  <section id="loginSection" class="card" style="display:none;">
    <h3>Login (Sementara)</h3>
    <p class="small">Untuk demo lomba cukup gunakan 1 akun (fitur login akan dikembangkan nanti).</p>
  </section>
</main>

<script>
const laporanData = [];
const menuBtn = document.getElementById('menuBtn');
const sidebar = document.getElementById('sidebar');
menuBtn.addEventListener('click', ()=> sidebar.classList.toggle('active'));

function goto(page){
  ['laporanSection','statistikSection','amanSection','loginSection'].forEach(x=>{
    document.getElementById(x).style.display='none';
  });
  document.getElementById(page+'Section').style.display='block';
  sidebar.classList.remove('active');
}
showSection('laporanSection');

function showSection(id){
  ['laporanSection','statistikSection','amanSection','loginSection'].forEach(x=>{
    document.getElementById(x).style.display='none';
  });
  document.getElementById(id).style.display='block';
}

const provEl = document.getElementById('provinsi');
const kotaEl = document.getElementById('kota');
const daerahEl = document.getElementById('daerah');
const kotaWrap = document.getElementById('kotaWrap');
const daerahWrap = document.getElementById('daerahWrap');
const statusWrap = document.getElementById('statusWrap');
const descWrap = document.getElementById('descWrap');
const submitWrap = document.getElementById('submitWrap');
const summaryDiv = document.getElementById('summary');

const wilayah = {
  "Jawa Timur": { "Surabaya": ["Genteng","Wonokromo","Rungkut","Tandes","Kenjeran"], "Sidoarjo": ["Krian","Waru","Buduran","Porong","Candi"], "Banyuwangi": ["Genteng","Rogojampi","Glagah","Kabupaten Kota"] },
  "Jawa Barat": { "Bandung": ["Coblong","Sukajadi","Cicendo"], "Bekasi": ["Bekasi Timur","Bekasi Selatan"] },
  "DKI Jakarta": { "Jakarta Pusat": ["Gambir","Menteng"], "Jakarta Timur": ["Duren Sawit","Cakung"] }
};

provEl.addEventListener('change', ()=>{
  const prov = provEl.value;
  kotaEl.innerHTML = '<option value="">-- Pilih Kota --</option>';
  daerahEl.innerHTML = '<option value="">-- Pilih Daerah --</option>';
  kotaWrap.style.display = daerahWrap.style.display = statusWrap.style.display = descWrap.style.display = submitWrap.style.display = 'none';
  summaryDiv.innerHTML='';
  if(prov && wilayah[prov]){
    Object.keys(wilayah[prov]).forEach(k=>{
      const o=document.createElement('option'); o.value=k; o.textContent=k; kotaEl.appendChild(o);
    });
    kotaWrap.style.display='block';
  }
});

kotaEl.addEventListener('change', ()=>{
  const prov=provEl.value, kota=kotaEl.value;
  daerahEl.innerHTML='<option value="">-- Pilih Daerah --</option>';
  daerahWrap.style.display=statusWrap.style.display=descWrap.style.display=submitWrap.style.display='none';
  summaryDiv.innerHTML='';
  if(prov && kota && wilayah[prov] && wilayah[prov][kota]){
    wilayah[prov][kota].forEach(d=>{
      const o=document.createElement('option'); o.value=d; o.textContent=d; daerahEl.appendChild(o);
    });
    daerahWrap.style.display='block';
  }
});

daerahEl.addEventListener('change', ()=>{
  const daerah = daerahEl.value;
  statusWrap.style.display=descWrap.style.display=submitWrap.style.display='none';
  summaryDiv.innerHTML='';
  if(daerah){
    statusWrap.style.display=descWrap.style.display=submitWrap.style.display='block';
    updateSummaryForSelected();
  }
});

document.getElementById('submitBtn').addEventListener('click', ()=>{
  const prov = provEl.value, kota=kotaEl.value, daerah=daerahEl.value;
  const status=document.getElementById('status').value;
  const deskripsi=document.getElementById('deskripsi').value||'';
  if(!prov||!kota||!daerah||!status){ alert('Lengkapi semua pilihan'); return; }
  const t=new Date().toLocaleString();
  laporanData.unshift({provinsi:prov,kota:kota,daerah:daerah,status:status,deskripsi:deskripsi,waktu:t});
  document.getElementById('status').value='';
  document.getElementById('deskripsi').value='';
  alert('âœ… Laporan berhasil dikirim!');
  updateStatistikTable(); updateSummaryForSelected();
});

function updateStatistikTable(){
  const statsTable=document.getElementById('statsTable');
  const tbody=document.getElementById('statsTbody');
  const statsSummary=document.getElementById('statsSummary');
  const recentList=document.getElementById('recentList');
  if(laporanData.length===0){ statsSummary.innerHTML='Belum ada laporan masuk.'; statsTable.style.display='none'; recentList.innerHTML=''; return; }
  const grouping={};
  laporanData.forEach(l=>{
    const key=`${l.daerah}, ${l.kota}`;
    if(!grouping[key]) grouping[key]={Lancar:0,Ramai:0,Padat:0,Macet:0};
    if(grouping[key][l.status]!==undefined) grouping[key][l.status]++;
  });
  tbody.innerHTML='';
  laporanData.forEach(l=>{
  });
  for(const key of Object.keys(grouping)){
    const row=grouping[key];
    const total=row.Lancar+row.Ramai+row.Padat+row.Macet;
    const maxCount=Math.max(row.Lancar,row.Ramai,row.Padat,row.Macet);
    let winners=['Lancar','Ramai','Padat','Macet'].filter(k=>row[k]===maxCount && maxCount>0);
    const mayoritas=winners.length===1?winners[0]:'Seimbang';
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${key}</td>
                  <td class="status-lancar">${row.Lancar}</td>
                  <td class="status-ramai">${row.Ramai}</td>
                  <td class="status-padat">${row.Padat}</td>
                  <td class="status-macet">${row.Macet}</td>
                  <td>${total}</td>
                  <td><b>${mayoritas}</b></td>`;
    tbody.appendChild(tr);
  }
  statsSummary.innerHTML=`Total laporan: <b>${laporanData.length}</b> â€¢ Daerah terlapor: <b>${Object.keys(grouping).length}</b>`;
  statsTable.style.display='table';
  recentList.innerHTML='';
  laporanData.slice(0,10).forEach(r=>{
    const div=document.createElement('div');
    div.style.padding='6px 0';
    div.innerHTML=`<b>[${r.waktu}]</b> ${r.daerah}, ${r.kota} â€” <span class="small">${r.status}</span> ${r.deskripsi?'- '+escapeHtml(r.deskripsi):''}`;
    recentList.appendChild(div);
  });
}

function updateSummaryForSelected(){
  const prov=provEl.value,kota=kotaEl.value,daerah=daerahEl.value,sDiv=document.getElementById('summary');
  sDiv.innerHTML='';
  if(!prov||!kota||!daerah) return;
  const counts={Lancar:0,Ramai:0,Padat:0,Macet:0};
  laporanData.forEach(l=>{ if(l.provinsi===prov && l.kota===kota && l.daerah===daerah){ if(counts[l.status]!==undefined) counts[l.status]++; }});
  const total=counts.Lancar+counts.Ramai+counts.Padat+counts.Macet;
  let mayoritas='Belum ada laporan';
  if(total>0){
    const max=Math.max(counts.Lancar,counts.Ramai,counts.Padat,counts.Macet);
    const winners=Object.keys(counts).filter(k=>counts[k]===max && max>0);
    mayoritas=winners.length===1?winners[0]:'Seimbang';
  }
  sDiv.innerHTML=`
    <div style="margin-top:16px; text-align:center;">
      <div style="display:inline-block; padding:10px 16px; background:#f7f7f7; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.04);">
        <div style="font-size:14px;color:#555">Ringkasan untuk <b>${daerah}, ${kota}</b></div>
        <div style="margin-top:8px; text-align:left;">
          <div>Lancar: <b>${counts.Lancar}</b></div>
          <div>Ramai: <b>${counts.Ramai}</b></div>
          <div>Padat: <b>${counts.Padat}</b></div>
          <div>Macet: <b>${counts.Macet}</b></div>
          <div style="margin-top:8px;color:#222">Mayoritas: <b>${mayoritas}</b></div>
        </div>
      </div>
    </div>`;
}

function escapeHtml(s){ return (s+'').replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

updateStatistikTable();
</script>
</body>
</html>
